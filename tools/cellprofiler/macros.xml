<macros>
    <token name="@CP_VERSION@">3.1.9</token>
    <token name="@PY_VERSION@">2.7.16</token>
    <token name="@FORMATS@">jpg,png,tif,tiff,bmp,gif,pcx,ppm,psd,pbm,pgm,eps</token>

    <token name="@NEWLINE@">"\n"</token>
    <token name="@SPACES@">"    "</token> <!-- four spaces needed for CP pipeline file -->

    <xml name="output_pipeline_macro">
        <data name="out_file" from_work_dir="output" format="txt" label="Output pipeline" hidden="true">
        </data>
    </xml>

    <xml name="input_pipeline_macro">
        <param name="input_pipeline" type="data" format="data" label="Pipeline to select"/>
    </xml>

    <xml name="requirements" token_package="cellprofiler" token_version="@CP_VERSION@">
        <requirements>
            <requirement type="package" version="@VERSION@">@PACKAGE@</requirement>
        </requirements>
    </xml>

    <xml name="citations">
        <citations>
            <citation type="bibtex">
            @misc{galaxytoolscellprofiler,
            author = {Sun, Yi},
            year = {2020},
            title = {Cellprofiler Galaxy tools},
            publisher = {Github},
            journal = {Github repository},
            url = {https://github.com/sunyi000/galaxytools},
            }
            </citation>
        </citations>
    </xml>

    <xml name="stdio">
        <stdio>
            <exit_code range="1:" level="fatal" description="Error occured"/>
        </stdio>
    </xml>

    <xml name="cmd_modules">
        <command><![CDATA[
            python '$script_file' '$inputs' '$input_pipeline'
        ]]></command>
    </xml>

    <xml name="text_validator">
        <validator type="regex" message="Only numbers, letters, hyphen and underscore and spaces are allowed">^[A-Za-z0-9 _-]*$</validator>
    </xml>

    <xml name="test_input_pipeline_param">
        <param name="input_pipeline" value="common.txt" />
    </xml>

    <xml name="test_out_file" token_file="common.txt">
        <output name="out_file" ftype="txt" file="@FILE@" lines_diff="0"/>
    </xml>
    
    <xml name="help" token_module="common">
       <help>
           This tool appends the inputs of the @MODULE@ module to an existing pipeline file (.cppipe)

           Input: existing pipeline file

           Output: new pipeline file

           Combine this tool with "Common" tool and "CellProfiler" tool together to run the current module alone.
       </help>
   </xml>
</macros>

